import numpy as np


def inverse(B):
    return np.linalg.inv(B)


def Cartesian_to_Internal(A, B):
    for i in A:
        print(np.inner(B, i))


if __name__ == "__main__":

    B = np.array(
        [[9.2974, 9.2974, 0.00], [-16.103569, 16.103569, 0.0], [0.0, 0.0, 13.5100]]
    )

    Bi = inverse(B)  # inverse

    CArray = np.array(
        [
            [9.2974000000, 0.0000000000, 1.0650000000],
            [0.0000000000, -2.6838208393, -3.0650000000],
            [2.3243500000, 1.3420714553, -3.0650000000],
            [4.6487000000, 5.3679637499, -3.0650000000],
            [-2.3243500000, -6.7097131338, -3.0650000000],
            [4.6487000000, -2.6838208393, -3.0650000000],
            [6.9730500000, 1.3420714553, -3.0650000000],
            [0.0000000000, -10.7356054284, -3.0650000000],
            [-2.3243500000, 9.3938560445, -3.0650000000],
            [0.0000000000, 13.4197483390, -3.0650000000],
            [0.0000000000, 5.3679637499, -3.0650000000],
        ]
    )

    CArray2 = np.array(
        [
            [9.2974000000, 0.0000000000, 1.0712857790],
            [0.0000000000, -2.6862280017, -3.0650000000],
            [2.3182773004, 1.3453978146, -3.0650000000],
            [4.6426894952, 5.3713997023, -3.0650000000],
            [-2.3223581421, -6.7086719805, -3.0650000000],
            [4.6286496329, -2.6955052899, -3.0650000000],
            [6.9571045896, 1.3511712332, -3.0845330662],
            [0.0000000000, -10.7125621473, -3.0650000000],
            [-2.3244123512, 9.3867738629, -3.0650000000],
            [0.0000000000, 13.4012299752, -3.0845417143],
            [0.0000000000, 5.3678571960, -3.0650000000],
        ]
    )

    print("Initial Positions:")
    Cartesian_to_Internal(CArray, Bi)

    print("Relaxed Positions:")
    Cartesian_to_Internal(CArray2, Bi)
